(window.webpackJsonp=window.webpackJsonp||[]).push([[159],{65391:function(t,e,r){"use strict";r.r(e),r.d(e,"JQUERY_CDN",(function(){return O}));var n=r("1d967"),o=r.n(n),c=r("279f1"),d=r.n(c),l=r("4047f"),f=r("d3037"),m=r("6876d"),h=r("02387"),v=r("a71f0"),x=r("dbe19"),w=r("ff287"),y=r.n(w);function C(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function k(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?C(Object(source),!0).forEach((function(e){d()(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):C(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var O="https://cdn1.ozone.ru/js/jquery/jquery-1.12.4.min.js",j={},E=f.a.extend({name:"CustomHtml",inject:{isMobile:{default:!1}},props:{context:{type:String,default:""}},data:function(){return{cartAddContext:null}},computed:k(k({},Object(m.e)({cartItemsHash:function(t){return t.cartGlobal.itemsHash}})),{},{nonce:function(){return y()(this.$store.state,"browser.cspNonce")},cartUrl:function(){return h.a.CART},isInCart:function(){return Boolean(this.cartItemsHash&&this.cartItemsHash[this.id])},style:function(){return'<style type="text/css">'.concat(this.widgetState.css,"</style>")}}),methods:{addInlineScript:function(content){var t=document.createElement("script");t.textContent="try {".concat(content,"} catch (error) {console.log('Widget custom html error', error)}"),t.setAttribute("nonce",this.nonce),this.$refs.customHtml.appendChild(t)},addToCart:function(t){var e=this;return o()(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t.detail,e.isInCart){r.next=4;break}return r.next=4,e.$store.dispatch("cartGlobal/UPDATE_ITEMS_IN_CART",{ids:[{id:n,spaceContext:e.context}],method:"post"});case 4:e.$composerRouter.redirect("".concat(e.cartUrl,"/#cartItem=").concat(n));case 5:case"end":return r.stop()}}),r)})))()},loadFiles:l.c,addFile:function(t){var e=this;return o()(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!j[t]){r.next=2;break}return r.abrupt("return",!1);case 2:return r.next=4,e.loadFiles(t,!0,!1,e.nonce);case 4:j[t]=r.sent;case 5:case"end":return r.stop()}}),r)})))()},loadResources:function(){var t=this;return o()(regeneratorRuntime.mark((function e(){var content,r,i,n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:content=t.widgetState,r=Array.isArray(content.resources)?content.resources:[],i=0;case 3:if(!(i<r.length)){e.next=11;break}if(n=r[i],o=n.type,c=n.value,!(["script","style"].indexOf(o)>=0)){e.next=8;break}return e.next=8,t.addFile(c);case 8:i++,e.next=3;break;case 11:case"end":return e.stop()}}),e)})))()},toogleModalLogin:function(){return o()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.a.showAuthForm();case 2:case"end":return t.stop()}}),t)})))()},handleTrackerEvent:function(t){v.a.send(t.action,{widget:this.trackingInfo,slice:this.sliceTrackingInfo||{},cell:t.cell||{}})}},mounted:function(){var t=this;return o()(regeneratorRuntime.mark((function e(){var content,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(content=t.widgetState,r=String(content.js),n=content.resources,t.cartAddContext=t.addToCart.bind(t),!r&&!n.length){e.next=10;break}if(content.disableJquery){e.next=8;break}return e.next=8,t.addFile(O);case 8:return e.next=10,t.loadResources();case 10:if(t.$refs.customHtmlContainer.addEventListener("addToCart",t.cartAddContext,!0),t.$refs.customHtmlContainer.addEventListener("toogleModalLogin",t.toogleModalLogin,!0),t.$refs.customHtmlContainer.addEventListener("trackerEvent",t.handleTrackerEvent,!0),e.t0=r.length,!e.t0){e.next=17;break}return e.next=17,t.addInlineScript(r);case 17:case"end":return e.stop()}}),e)})))()},destroyed:function(){this.$refs.customHtmlContainer&&(this.$refs.customHtmlContainer.removeEventListener("addToCart",this.cartAddContext),this.$refs.customHtmlContainer.removeEventListener("toogleModalLogin",this.toogleModalLogin),this.$refs.customHtmlContainer.removeEventListener("trackerEvent",this.handleTrackerEvent,!0))}}),H=r("b429c"),component=Object(H.a)(E,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{directives:[{name:"qa",rawName:"v-qa:id",value:this.groupStatePath,expression:"groupStatePath",arg:"id"}],ref:"customHtml",class:["custom-html",this.isMobile?"mobile":"desktop"]},[e("div",{domProps:{innerHTML:this._s(this.style)}}),this._v(" "),e("div",{ref:"customHtmlContainer",staticClass:"custom-html__container",domProps:{innerHTML:this._s(this.widgetState.html)}})])}),[],!1,null,null,null);e.default=component.exports}}]);